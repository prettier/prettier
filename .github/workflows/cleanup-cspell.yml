name: Cleanup cspell.json

on:
  workflow_dispatch:
  schedule:
    # “At every minute on Monday in January.” https://crontab.guru/#*_*_*_1_1
    - cron: "* * * 1 1"

permissions:
  pull-requests: write
  contents: write

jobs:
  run:
    name: Cleanup cspell.json
    if: github.event_name != 'schedule' || github.repository == 'prettier/prettier'
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v5

      - name: Setup Node.js
        uses: actions/setup-node@v5
        with:
          cache: "yarn"

      - name: Install Dependencies
        run: yarn install --immutable

      - name: Run script
        run: node scripts/clean-cspell.js

      - uses: peter-evans/create-pull-request@v7
        with:
          commit-message: Cleanup cspell.json
          branch: automated-update
          branch-suffix: timestamp
          title: Cleanup cspell.json
